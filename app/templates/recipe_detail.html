<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>RecipeApp - –î–µ—Ç–∞–ª–∏ —Ä–µ—Ü–µ–ø—Ç–∞</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">üç≥ RecipeApp</div>
            <div class="nav-links">
                <a href="/">–í—Å–µ —Ä–µ—Ü–µ–ø—Ç—ã</a>
                <a href="/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
            </div>
        </div>
    </nav>

    <div class="main-container">
        <div class="recipe-detail" id="recipeContainer">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            <div class="loader">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ—Ü–µ–ø—Ç–∞...</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            const recipeId = window.location.pathname.split('/').pop();
            await loadRecipe(recipeId);
        });

        async function loadRecipe(recipeId) {
            try {
                const response = await fetch(`/api/recipe/${recipeId}`);
                if (!response.ok) throw new Error('–†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');

                const recipe = await response.json();
                renderRecipe(recipe);

            } catch (error) {
                document.getElementById('recipeContainer').innerHTML = `
                    <div class="error-message">
                        ‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Ü–µ–ø—Ç–∞: ${error.message}
                    </div>
                `;
            }
        }

        function renderRecipe(recipe) {
            const container = document.getElementById('recipeContainer');
            container.innerHTML = `
                <h1 class="recipe-title">${recipe.title}</h1>

                <div class="recipe-header">
                    <img src="${recipe.image_url || '/static/default-recipe.jpg'}"
                         alt="${recipe.title}"
                         class="recipe-main-image">

                    <div class="recipe-info">
                        <div class="info-block">
                            <span class="info-label">‚è± –í—Ä–µ–º—è –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è:</span>
                            <span class="info-value">${recipe.cooking_time} –º–∏–Ω</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">‚≠ê –†–µ–π—Ç–∏–Ω–≥:</span>
                            <span class="info-value">${recipe.average_rating?.toFixed(1) || '–ù–µ—Ç –æ—Ü–µ–Ω–æ–∫'}</span>
                        </div>
                        <div class="info-block">
                            <span class="info-label">üçΩ –ö—É—Ö–Ω—è:</span>
                            <span class="info-value">${recipe.cuisine || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</span>
                        </div>
                    </div>
                </div>

                <div class="recipe-section">
                    <h2>–û–ø–∏—Å–∞–Ω–∏–µ</h2>
                    <div class="description">
                        ${recipe.description || "–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"}
                    </div>
                </div>

                ${recipe.giga_chat_description ? `
                <div class="recipe-section">
                    <h2>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑ GigaChat</h2>
                    <div class="giga-chat">
                        ${recipe.giga_chat_description}
                    </div>
                </div>` : ''}
            `;
        }
    </script>
</body>
</html>